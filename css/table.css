/* ==========================================================================
   COMPLETE CSV TABLE FIX - Replace ALL existing table styles
   ========================================================================== */

/* üìä CONTAINER SETUP - CRITICAL FOR SCROLLING */
#csv-editor-tab {
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden; /* Prevent container overflow */
}

#csv-editor-tab .output-header {
    flex-shrink: 0; /* Don't shrink header */
    background-color: var(--color-bg-secondary);
    border-bottom: 1px solid var(--color-border-primary);
    padding: var(--space-4) var(--space-6);
}

/* The padding div around table */
#csv-editor-tab > div:last-child {
    flex: 1; /* Take remaining space */
    display: flex;
    flex-direction: column;
    overflow: hidden;
    padding: var(--space-6);
}

#csvCellDetailPreviewer {
    flex-shrink: 0; /* Don't shrink previewer */
    background-color: var(--color-bg-secondary);
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-base);
    padding: var(--space-4);
    margin-bottom: var(--space-4);
    min-height: 60px;
    max-height: 120px;
    overflow-y: auto;
}

/* üìã TABLE CONTAINER - THE SCROLLING AREA */
.csv-table-container {
    flex: 1; /* Take remaining space after previewer */
    border: 1px solid var(--color-border-primary);
    border-radius: var(--radius-base);
    overflow: auto; /* Enable scrolling */
    background-color: var(--color-bg-overlay);
    position: relative;
    
    /* CRITICAL: Force the container to have defined dimensions */
    min-height: 0; /* Allow flex shrinking */
    width: 100%;
}

/* üìä TABLE ITSELF - REMOVE CONFLICTING LAYOUT */
.csv-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    font-size: var(--font-size-sm);
    table-layout: auto; /* Let columns size naturally */
    background-color: transparent;
    margin: 0;
    
    /* REMOVE any min-width that might cause issues */
    min-width: max-content;
}

/* üè∑Ô∏è REMOVE COLGROUP INTERFERENCE */
.csv-table colgroup {
    display: none; /* Disable colgroup to prevent width conflicts */
}

/* üìã HEADER ROW - STICKY POSITIONING */
.csv-table thead {
    position: sticky;
    top: 0;
    z-index: 10;
    background-color: var(--color-bg-secondary);
}

.csv-table thead tr {
    background-color: var(--color-bg-secondary);
}

.csv-table th {
    background-color: var(--color-bg-secondary);
    color: var(--color-text-primary);
    font-weight: var(--font-weight-semibold);
    text-align: left;
    vertical-align: middle;
    
    /* CONSISTENT PADDING */
    padding: 12px 16px;
    
    /* BORDERS */
    border-bottom: 2px solid var(--color-border-primary);
    border-right: 1px solid var(--color-border-primary);
    
    /* TEXT HANDLING */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    
    /* SIZE CONSTRAINTS */
    min-width: 150px;
    width: auto; /* Let it size naturally */
    max-width: 400px;
    
    /* STICKY POSITIONING */
    position: sticky;
    top: 0;
    background-clip: padding-box;
}

.csv-table th:last-child {
    border-right: none;
}

/* üìù DATA ROWS */
.csv-table tbody tr {
    background-color: var(--color-bg-overlay);
    transition: background-color var(--transition-fast);
}

.csv-table tbody tr:hover {
    background-color: var(--color-surface-hover);
}

/* üì± DATA CELLS - MATCH HEADER DIMENSIONS */
.csv-table td {
    padding: 0; /* Padding goes in wrapper */
    border-right: 1px solid var(--color-border-primary);
    border-bottom: 1px solid var(--color-border-primary);
    vertical-align: top;
    position: relative;
    
    /* SIZE CONSTRAINTS - MATCH HEADERS */
    min-width: 150px;
    width: auto;
    max-width: 400px;
    
    /* HEIGHT */
    height: 36px;
    min-height: 36px;
}

.csv-table td:last-child {
    border-right: none;
}

.csv-table tbody tr:last-child td {
    border-bottom: none;
}

/* üìÑ CELL CONTENT WRAPPER */
.cell-content-wrapper {
    /* MATCH HEADER PADDING EXACTLY */
    padding: 12px 16px;
    
    /* LAYOUT */
    height: 36px;
    display: flex;
    align-items: center;
    width: 100%;
    box-sizing: border-box;
    
    /* TEXT HANDLING */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    
    /* INTERACTION */
    cursor: pointer;
    transition: background-color var(--transition-fast);
    color: var(--color-text-primary);
    background-color: transparent;
}

.cell-content-wrapper:hover {
    background-color: var(--color-surface-hover);
}

/* üéØ SELECTION STATE */
.csv-table td.selected-cell .cell-content-wrapper {
    background-color: var(--color-surface-selected);
    box-shadow: inset 0 0 0 2px var(--color-border-accent);
}

/* ‚úèÔ∏è EDITING STATE */
.csv-table td.editing {
    padding: 0;
    background-color: white !important;
}

.csv-table td.editing .cell-content-wrapper {
    display: none;
}

.csv-table td.editing input {
    width: 100%;
    height: 36px;
    padding: 12px 16px; /* Match wrapper padding */
    border: none;
    outline: none;
    background-color: white;
    color: var(--color-text-primary);
    font-family: inherit;
    font-size: inherit;
    box-shadow: inset 0 0 0 2px var(--primary-600);
    margin: 0;
    box-sizing: border-box;
}

/* üé® HOVER EFFECTS */
.csv-table th.column-hover-header {
    background-color: var(--primary-100);
}

.csv-table td.column-hover .cell-content-wrapper {
    background-color: var(--primary-50);
}

/* üìè SCROLLBARS */
.csv-table-container::-webkit-scrollbar {
    width: 14px;
    height: 14px;
}

.csv-table-container::-webkit-scrollbar-track {
    background: var(--color-bg-secondary);
}

.csv-table-container::-webkit-scrollbar-thumb {
    background: var(--neutral-400);
    border-radius: 7px;
    border: 3px solid var(--color-bg-secondary);
}

.csv-table-container::-webkit-scrollbar-thumb:hover {
    background: var(--neutral-600);
}

.csv-table-container::-webkit-scrollbar-corner {
    background: var(--color-bg-secondary);
}

/* üì± RESPONSIVE */
@media (max-width: 768px) {
    .csv-table {
        font-size: var(--font-size-xs);
    }
    
    .csv-table th,
    .csv-table td {
        min-width: 120px;
    }
    
    .csv-table th,
    .cell-content-wrapper {
        padding: 8px 12px;
    }
    
    .csv-table td,
    .cell-content-wrapper {
        height: 32px;
        min-height: 32px;
    }
    
    .csv-table td.editing input {
        height: 32px;
        padding: 8px 12px;
    }
}
